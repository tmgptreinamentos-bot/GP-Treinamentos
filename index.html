<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Solicitação de Cursos</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #000;
        color: #FFD700;
        margin: 0;
        padding: 20px;
    }
    h1 {
        text-align: center;
        margin-bottom: 30px;
    }
    .form-section {
        background: #111;
        padding: 20px;
        border-radius: 10px;
        max-width: 500px;
        margin: 0 auto 30px auto;
        border: 1px solid #FFD700;
    }
    .course-list {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: center;
    }
    .course-item {
        width: 200px;
        background: #111;
        border: 1px solid #FFD700;
        border-radius: 10px;
        padding: 10px;
        text-align: center;
    }
    .course-item img {
        width: 100%;
        border-radius: 8px;
    }
    button {
        background: #FFD700;
        color: #000;
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        cursor: pointer;
        margin-top: 20px;
        display: block;
        width: 100%;
    }
    button:hover {
        background: #e0c000;
    }
    .success {
        margin-top: 20px;
        text-align: center;
        color: #7CFC00;
        font-size: 18px;
    }
</style>
</head>
<body>

<h1>Solicitação de Cursos</h1>

<div class="form-section">
    <label>Nome:</label>
    <input id="nome" type="text" style="width:100%;padding:8px;margin-bottom:10px;"><br>

    <label>Telefone:</label>
    <input id="telefone" type="text" style="width:100%;padding:8px;margin-bottom:10px;"><br>

    <label>E-mail:</label>
    <input id="email" type="email" style="width:100%;padding:8px;margin-bottom:20px;"><br>

    <button onclick="enviarSolicitacao()">Solicitar Cursos Selecionados</button>

    <div id="msg" class="success"></div>
</div>

<h2 style="text-align:center">Selecione os Cursos</h2>
<div id="listaCursos" class="course-list"></div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzAQozrqKD_zwMbAZY4cPU_tpsPYVk1Wsp6Z2JM4D9o8c3tNAbgKUftaU6rmQWoIZvO/exec";


// Buscar os cursos da planilha
fetch(SCRIPT_URL + "?action=listar")
  .then(r => r.json())
  .then(cursos => {
      let container = document.getElementById("listaCursos");
      container.innerHTML = "";

      cursos.forEach(c => {
          container.innerHTML += `
              <div class="course-item">
                  <img src="${c.imagem}">
                  <h3>${c.nome}</h3>
                  <input type="checkbox" value="${c.pdf}">
                  Selecionar
              </div>
          `;
      });
  });

// Enviar solicitação
function enviarSolicitacao() {
    let nome = document.getElementById("nome").value.trim();
    let telefone = document.getElementById("telefone").value.trim();
    let email = document.getElementById("email").value.trim();

    if (!nome || !telefone || !email) {
        alert("Preencha Nome, Telefone e E-mail antes de solicitar!");
        return;
    }

    let selecionados = [...document.querySelectorAll("input[type=checkbox]:checked")]
                          .map(x => x.value);

    if (selecionados.length === 0) {
        alert("Selecione pelo menos um curso!");
        return;
    }

    fetch(SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify({
            action: "solicitar",
            nome, telefone, email,
            pdfs: selecionados
        })
    })
    .then(r => r.text())
    .then(resp => {
        document.getElementById("msg").innerText = "Solicitação enviada com sucesso!";
    });
}
</script>

</body>
</html>
